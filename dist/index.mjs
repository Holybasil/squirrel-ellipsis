"use client";
import s,{useEffect as h,useMemo as F,useRef as d,useState as g}from"react";var C={position:"absolute",bottom:0,left:0,height:0,overflow:"hidden",paddingTop:0,paddingBottom:0,border:"none"},U=["box-sizing","width","font-size","font-weight","font-family","font-style","letter-spacing","text-indent","white-space","word-break","overflow-wrap","padding-left","padding-right"];var D=L=>{let{component:$="div",ellipsis:b=s.createElement(s.Fragment,null,"\u2009...\u2009"),basedOn:T,maxLine:x,text:o,className:w,action:m="more",trimEndPunc:E=!0,onReflow:M,...O}=L,[S,q]=g(o),[u,v]=g(x),[f,z]=g(!1),c=d([]),l=d(),a=d(),y=d(),N=d(0),P=F(()=>{let e=(f?S:o).trimEnd();return E&&f&&(e=e.replace(/[.,;:!?，。；：！？]+$/,"")),e},[o,S,E,f]);h(()=>{q(o)},[o]),h(()=>{v(x)},[x]),h(()=>{let e=r=>{a.current&&(j(),I({basedOn:T,text:o,maxLine:u}))},t=new ResizeObserver(e);return t.observe(a.current),()=>{a.current&&t&&t.unobserve(a.current)}},[T,o,u]);let j=()=>{let e=window.getComputedStyle(a.current);U.forEach(t=>{l.current.style[t]=e[t]})},I=e=>{let t=e.basedOn||(/^[\x00-\x7F]+$/.test(e.text)?"words":"letters");t==="words"?c.current=e.text.split(/\b|(?=\W)/):t==="letters"?c.current=Array.from(e.text):c.current=e.text.split(/\b|(?=\W)/),l.current.innerHTML=c.current.map(p=>`<span class='squirrel-ellipsis-unit'>${p}</span>`).join("");let r=W(k()),i=r>-1,n=i?c.current.slice(0,r).join(""):e.text;z(i),q(n),a.current.offsetHeight<=N.current&&M(i,n)},k=()=>{let e=[0],t=l.current.firstElementChild;if(!t)return e;let r=0,i=1,n=t.offsetTop;for(;(t=t.nextElementSibling)&&(r++,t.offsetTop>n&&(i++,e.push(r),n=t.offsetTop),!(i>u)););return e},W=e=>{if(!u||e.length<=u)return-1;let t=e[u],r=c.current.slice(0,t),i=l.current.children[t].offsetTop;N.current=i,l.current.innerHTML=r.map((B,G)=>`<span class='squirrel-ellipsis-unit'>${B}</span>`).join("")+`<span class='squirrel-ellipsis-tail'>${y.current.innerHTML}</span>`;let n=l.current.lastElementChild,p=n.previousElementSibling;for(;p&&(n.offsetTop>=i||n.offsetTop>p.offsetTop||n.offsetHeight>p.offsetHeight);)l.current.removeChild(p),p=n.previousElementSibling,r.pop();return r.length},A=()=>{v(null)};return s.createElement(s.Fragment,null,s.createElement($,{className:`squirrel-ellipsis ${f?"squirrel-ellipsis-clamped":""} ${w||""}`,ref:a,...O},P,f&&s.createElement("span",{className:"squirrel-ellipsis-tail"},s.createElement("span",{className:"squirrel-ellipsis-suffix"},b),m&&s.createElement("span",{className:"squirrel-ellipsis-action",style:{cursor:"pointer"},role:"button",onClick:A},m))),s.createElement(s.Fragment,null,s.createElement("div",{style:C,ref:l,"aria-hidden":"true",className:`squirrel-ellipsis-shadow ${w}`}),s.createElement("span",{style:C,ref:y},s.createElement("span",{className:"squirrel-ellipsis-suffix"},b),m&&s.createElement("span",{className:"squirrel-ellipsis-action"},m))))},H=D;var V=H;export{V as default};
//# sourceMappingURL=index.mjs.map